### 引入

Java 并不像 C/C++ 那样需要程序员手动去回收内存。其内存的管理交给了 JVM 虚拟机。

![](http://ww4.sinaimg.cn/large/b10d1ea5jw1f85vza3uddj20i20bijsu.jpg)

### 运行时数据区域

Java 虚拟机执行程序时候，会将其管理的内存划分成不同的数据区域，这些区域有各种的用途。

#### 程序计数器

程序中一块较小的数据区域，可以看做是当前线程所执行的字节码的行号指示器。字节码解释器工作时候就通过这个计数器值的改变来选取下一条需要执行的字节码指令，分支、循环、跳转、异常处理、线程恢复等等。这一块区域是线程私有的，为了确保每一条线程独立的执行。

#### Java 虚拟机栈

线程私有，生命周期与线程相同。经常会有人把 Java 的内存区域分为栈内存和堆内存，很明显，在这里看来，这种分法明显不对。但是可见，对这两块内存区域的关注。虚拟机中的栈部分又称为局部变量表部分。其编译期存放了各种基本类型的数据(int boolean...)以及引用类型数据。局部 变量表所需要的内存空间在编译器进行分配，运行期是不会改变的。

#### 本地方法栈

本地方法栈与虚拟机栈所发挥的作用非常相似，区别就是虚拟机栈执行 Java 方法，而本地方法栈则为虚拟机所使用的到的 Native 方法服务。

#### Java 堆

Java 堆内存是 JVM 虚拟机内存所管理的内存区域最大的一块。其是所有线程共享的一块区域，几乎所有对象的初始化都在这里分配内存。Java 堆是内存管理的主要区域，可以称为 GC 堆。Java 堆中可以分为：新生代和老生代。更细致一点可以分为：Eden 空间、From Survivor 空间、To Survivor 空间。Java 堆只需要在逻辑上连续即可，就像我们的磁盘空间一样。

#### 方法区

方法堆与 Java 堆一样，是各个线程共享的区域。用于存储已经被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

#### 运行时常量池

运行时常量池是方法区的一部分。Class 文件中除了有类文件的版本，字段，方法，接口等描述信息之外，还有一类信息就是常量池。用于存放编译器生成的各种字面量和符号的引用。Java 语言并没有要求常量一定是在编译期间生成的，其实在运行时候也可以生成。

#### 直接内存

直接内存并不是虚拟机运行时数据区域的一部分，也不是 java 虚拟机中定义的虚拟内存。但是由于经常一起使用，所以放在一起。